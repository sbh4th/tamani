% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\title{Group-Time ATTs}
\author{Sam Harper}
\date{2021-11-02}

\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Group-Time ATTs},
  pdfauthor={Sam Harper},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}
\usepackage{siunitx}
\newcolumntype{d}{S[input-symbols = ()]}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\begin{document}
\maketitle

\hypertarget{standard-two-way-fixed-effects}{%
\section{Standard Two-Way Fixed
Effects}\label{standard-two-way-fixed-effects}}

First, let's read in the Stata dataset, and create a smaller version
with just the variables of interest for looking at skilled birth
attendance:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d }\OtherTok{\textless{}{-}} \FunctionTok{read\_dta}\NormalTok{(}\FunctionTok{here}\NormalTok{(}\StringTok{"data{-}clean"}\NormalTok{, }\StringTok{"hh\_female\_impact\_rpt.dta"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{mutate}\NormalTok{(}\AttributeTok{district =} \FunctionTok{as\_factor}\NormalTok{(hh1, }\AttributeTok{levels =} \StringTok{"labels"}\NormalTok{),}
         \AttributeTok{time =} \FunctionTok{as.numeric}\NormalTok{(delwave) }\SpecialCharTok{+} \DecValTok{1}\NormalTok{,}
         \AttributeTok{sba\_birth =} \FunctionTok{as.numeric}\NormalTok{(sba\_birth))}

\CommentTok{\# restrict to variables for analysis}
\NormalTok{d\_ind }\OtherTok{\textless{}{-}}\NormalTok{ d }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(district, sba\_birth, txdel, time) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{dist\_id =} \FunctionTok{as.numeric}\NormalTok{(district)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{drop\_na}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(district, dist\_id) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{group =} \FunctionTok{min}\NormalTok{(}\FunctionTok{if\_else}\NormalTok{(txdel}\SpecialCharTok{==}\DecValTok{1}\NormalTok{, time, }\DecValTok{5}\NormalTok{)),}
         \AttributeTok{g2 =} \FunctionTok{if\_else}\NormalTok{(group}\SpecialCharTok{==}\DecValTok{2}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{),}
         \AttributeTok{g3 =} \FunctionTok{if\_else}\NormalTok{(group}\SpecialCharTok{==}\DecValTok{3}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{),}
         \AttributeTok{g4 =} \FunctionTok{if\_else}\NormalTok{(group}\SpecialCharTok{==}\DecValTok{4}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{)) }

\FunctionTok{kable}\NormalTok{(}\FunctionTok{head}\NormalTok{(d\_ind)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_styling}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\begin{tabular}{l|r|r|r|r|r|r|r|r}
\hline
district & sba\_birth & txdel & time & dist\_id & group & g2 & g3 & g4\\
\hline
Kaliua DC & 0 & 0 & 1 & 1 & 2 & 1 & 0 & 0\\
\hline
Kaliua DC & 1 & 1 & 5 & 1 & 2 & 1 & 0 & 0\\
\hline
Kaliua DC & 0 & 1 & 5 & 1 & 2 & 1 & 0 & 0\\
\hline
Kaliua DC & 0 & 0 & 1 & 1 & 2 & 1 & 0 & 0\\
\hline
Kaliua DC & 1 & 1 & 5 & 1 & 2 & 1 & 0 & 0\\
\hline
Kaliua DC & 1 & 1 & 5 & 1 & 2 & 1 & 0 & 0\\
\hline
\end{tabular}
\end{table}

Using this data, let's now run the standard TWFE analysis that is the
workhorse of most DD applications with differential treatment timing.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Get TWFE coefficient from individual{-}level dataset}
\NormalTok{twfe }\OtherTok{\textless{}{-}}\NormalTok{ fixest}\SpecialCharTok{::}\FunctionTok{feols}\NormalTok{(sba\_birth }\SpecialCharTok{\textasciitilde{}}\NormalTok{ txdel }\SpecialCharTok{|}\NormalTok{ district }\SpecialCharTok{+}\NormalTok{ time, }
                      \AttributeTok{data =}\NormalTok{ d,}
                      \AttributeTok{weights =} \ConstantTok{NULL}\NormalTok{, }
                      \AttributeTok{cluster =} \SpecialCharTok{\textasciitilde{}}\NormalTok{district)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## NOTE: 2,327 observations removed because of NA values (LHS: 2,327, Fixed-effects: 2,312).
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{twfe}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## OLS estimation, Dep. Var.: sba_birth
## Observations: 5,555 
## Fixed-effects: district: 8,  time: 5
## Standard-errors: Clustered (district) 
##       Estimate Std. Error t value Pr(>|t|) 
## txdel  0.05976   0.037325 1.60105   0.1534 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.425631     Adj. R2: 0.057514
##                  Within R2: 5.313e-4
\end{verbatim}

Specifying this using an OLS model with standard errors clustered at the
district level, we get a DD estimate that we would interpret as showing
that the intervention increased the probability of skilled birth
attendance by 6 percentage points (95\% CI -0.7 to 12.7).

Because the treatment is assigned at the cluster level and we aren't
adjusting for any covariates, we can also analyze this at the cluster
level. Next let's aggregate up to the district level. Here is a look at
the dataset:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d\_sba }\OtherTok{\textless{}{-}}\NormalTok{ d\_ind }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(district, dist\_id, time) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{tsba =} \FunctionTok{sum}\NormalTok{(sba\_birth),}
         \AttributeTok{tpop =} \FunctionTok{n}\NormalTok{(),}
         \AttributeTok{psba =}\NormalTok{ tsba }\SpecialCharTok{/}\NormalTok{ tpop, }\CommentTok{\# \% SBA}
         \AttributeTok{txdel =} \FunctionTok{mean}\NormalTok{(txdel),}
         \AttributeTok{group =} \FunctionTok{mean}\NormalTok{(group))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'district', 'dist_id'. You can override using the `.groups` argument.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d\_sba }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kbl}\NormalTok{(}\AttributeTok{digits=}\DecValTok{3}\NormalTok{, }\AttributeTok{escape =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_styling}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\begin{tabular}[t]{l|r|r|r|r|r|r|r}
\hline
district & dist_id & time & tsba & tpop & psba & txdel & group\\
\hline
Kaliua DC & 1 & 1 & 409 & 705 & 0.580 & 0 & 2\\
\hline
Kaliua DC & 1 & 2 & 49 & 73 & 0.671 & 1 & 2\\
\hline
Kaliua DC & 1 & 3 & 63 & 77 & 0.818 & 1 & 2\\
\hline
Kaliua DC & 1 & 4 & 9 & 10 & 0.900 & 1 & 2\\
\hline
Kaliua DC & 1 & 5 & 94 & 114 & 0.825 & 1 & 2\\
\hline
Nzega DC & 2 & 1 & 465 & 634 & 0.733 & 0 & 3\\
\hline
Nzega DC & 2 & 2 & 60 & 76 & 0.789 & 0 & 3\\
\hline
Nzega DC & 2 & 3 & 43 & 57 & 0.754 & 1 & 3\\
\hline
Nzega DC & 2 & 4 & 9 & 10 & 0.900 & 1 & 3\\
\hline
Nzega DC & 2 & 5 & 88 & 101 & 0.871 & 1 & 3\\
\hline
Nzega TC & 3 & 1 & 165 & 182 & 0.907 & 0 & 5\\
\hline
Nzega TC & 3 & 2 & 13 & 13 & 1.000 & 0 & 5\\
\hline
Nzega TC & 3 & 3 & 12 & 14 & 0.857 & 0 & 5\\
\hline
Nzega TC & 3 & 4 & 4 & 5 & 0.800 & 0 & 5\\
\hline
Nzega TC & 3 & 5 & 21 & 24 & 0.875 & 1 & 5\\
\hline
Sikonge DC & 4 & 1 & 310 & 374 & 0.829 & 0 & 5\\
\hline
Sikonge DC & 4 & 2 & 49 & 53 & 0.925 & 0 & 5\\
\hline
Sikonge DC & 4 & 3 & 23 & 27 & 0.852 & 0 & 5\\
\hline
Sikonge DC & 4 & 4 & 4 & 5 & 0.800 & 0 & 5\\
\hline
Sikonge DC & 4 & 5 & 44 & 52 & 0.846 & 1 & 5\\
\hline
Tabora MC & 5 & 1 & 540 & 614 & 0.879 & 0 & 4\\
\hline
Tabora MC & 5 & 2 & 53 & 59 & 0.898 & 0 & 4\\
\hline
Tabora MC & 5 & 3 & 39 & 44 & 0.886 & 0 & 4\\
\hline
Tabora MC & 5 & 4 & 6 & 6 & 1.000 & 1 & 4\\
\hline
Tabora MC & 5 & 5 & 82 & 86 & 0.953 & 1 & 4\\
\hline
Urambo DC & 6 & 1 & 158 & 193 & 0.819 & 0 & 2\\
\hline
Urambo DC & 6 & 2 & 15 & 17 & 0.882 & 1 & 2\\
\hline
Urambo DC & 6 & 3 & 20 & 25 & 0.800 & 1 & 2\\
\hline
Urambo DC & 6 & 4 & 2 & 3 & 0.667 & 1 & 2\\
\hline
Urambo DC & 6 & 5 & 25 & 30 & 0.833 & 1 & 2\\
\hline
Uyui DC & 7 & 1 & 338 & 514 & 0.658 & 0 & 4\\
\hline
Uyui DC & 7 & 2 & 60 & 81 & 0.741 & 0 & 4\\
\hline
Uyui DC & 7 & 3 & 29 & 57 & 0.509 & 0 & 4\\
\hline
Uyui DC & 7 & 4 & 6 & 10 & 0.600 & 1 & 4\\
\hline
Uyui DC & 7 & 5 & 63 & 81 & 0.778 & 1 & 4\\
\hline
Igunga DC & 8 & 1 & 522 & 821 & 0.636 & 0 & 3\\
\hline
Igunga DC & 8 & 2 & 67 & 89 & 0.753 & 0 & 3\\
\hline
Igunga DC & 8 & 3 & 40 & 68 & 0.588 & 1 & 3\\
\hline
Igunga DC & 8 & 4 & 15 & 20 & 0.750 & 1 & 3\\
\hline
Igunga DC & 8 & 5 & 94 & 131 & 0.718 & 1 & 3\\
\hline
\end{tabular}
\end{table}

You can see that we are aggregating up to the district level, and how we
have the total population (\texttt{tpop}) and the total number of births
with a skilled attendant (\texttt{tsba}), as well as the proportion by
district.

Now, we can also fit the TWFE model to this aggregate data, controlling
for district fixed effects and survey wave.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Compare to pooled sample}
\NormalTok{twfep }\OtherTok{\textless{}{-}}\NormalTok{ fixest}\SpecialCharTok{::}\FunctionTok{feols}\NormalTok{(psba }\SpecialCharTok{\textasciitilde{}}\NormalTok{ txdel }\SpecialCharTok{|}\NormalTok{ district }\SpecialCharTok{+}\NormalTok{ time, }
                      \AttributeTok{data =}\NormalTok{ d\_sba,}
                      \AttributeTok{weights =} \SpecialCharTok{\textasciitilde{}}\NormalTok{tpop, }
                      \AttributeTok{cluster =} \SpecialCharTok{\textasciitilde{}}\NormalTok{district)}

\NormalTok{twfep}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## OLS estimation, Dep. Var.: psba
## Observations: 40 
## Fixed-effects: district: 8,  time: 5
## Standard-errors: Clustered (district) 
##       Estimate Std. Error t value Pr(>|t|) 
## txdel  0.05976   0.039958 1.49557  0.17842 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.466034     Adj. R2: 0.826702
##                  Within R2: 0.058009
\end{verbatim}

The estimates from these two models are identical (SEs are very
minimally different), which is just to say that it is fine to work with
the aggregate data to estimate the impact of the intervention (absent
control for covariates):

\begin{table}
\centering
\begin{tabular}[t]{lcc}
\toprule
  & Individual & Aggregate\\
\midrule
txdel & \num{0.060} & \num{0.060}\\
 & (\num{0.037}) & (\num{0.040})\\
\midrule
Num.Obs. & \num{5555} & \num{40}\\
Std.Errors & by: district & by: district\\
FE: district & X & X\\
FE: time & X & X\\
\bottomrule
\end{tabular}
\end{table}

\hypertarget{callawaysantanna-approach}{%
\subsection{Callaway/Sant'Anna
Approach}\label{callawaysantanna-approach}}

Okay so we have the traditional DD estimate of around a 6 percentage
point increase in SBA. Now let's look at the Callaway-Sant'Anna DD
estimate. Since the CS DD approach functions by aggregating different
kinds of group-time DDs, we can also aggregate up to the group level,
since we have 2 groups being treated at each wave post-baseline. Let's
define a new variable \texttt{group} that indicates the time at which
each group was \emph{first} treated. So for Kaliua DC and\\
Urambo DC that were the first groups to be treated post-baseline (what
we will call time=2), they are assigned a value of \texttt{group=2}, and
so on for the other groups. Meanwhile, we are still aggregating up the
number of births with SBA and the total population of each group.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# create group{-}time aggregate data}
\NormalTok{d\_agg }\OtherTok{\textless{}{-}}\NormalTok{ d\_sba }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{group\_by}\NormalTok{(group, time) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{tsba =} \FunctionTok{sum}\NormalTok{(tsba),}
         \AttributeTok{tpop =} \FunctionTok{sum}\NormalTok{(tpop),}
         \AttributeTok{psba =}\NormalTok{ tsba }\SpecialCharTok{/}\NormalTok{ tpop, }\CommentTok{\# \% SBA}
         \AttributeTok{txdel =} \FunctionTok{mean}\NormalTok{(txdel))}

\NormalTok{d\_agg }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kbl}\NormalTok{(}\AttributeTok{digits=}\DecValTok{3}\NormalTok{, }\AttributeTok{escape =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_styling}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\begin{tabular}[t]{r|r|r|r|r|r}
\hline
group & time & tsba & tpop & psba & txdel\\
\hline
2 & 1 & 567 & 898 & 0.631 & 0\\
\hline
2 & 2 & 64 & 90 & 0.711 & 1\\
\hline
2 & 3 & 83 & 102 & 0.814 & 1\\
\hline
2 & 4 & 11 & 13 & 0.846 & 1\\
\hline
2 & 5 & 119 & 144 & 0.826 & 1\\
\hline
3 & 1 & 987 & 1455 & 0.678 & 0\\
\hline
3 & 2 & 127 & 165 & 0.770 & 0\\
\hline
3 & 3 & 83 & 125 & 0.664 & 1\\
\hline
3 & 4 & 24 & 30 & 0.800 & 1\\
\hline
3 & 5 & 182 & 232 & 0.784 & 1\\
\hline
4 & 1 & 878 & 1128 & 0.778 & 0\\
\hline
4 & 2 & 113 & 140 & 0.807 & 0\\
\hline
4 & 3 & 68 & 101 & 0.673 & 0\\
\hline
4 & 4 & 12 & 16 & 0.750 & 1\\
\hline
4 & 5 & 145 & 167 & 0.868 & 1\\
\hline
5 & 1 & 475 & 556 & 0.854 & 0\\
\hline
5 & 2 & 62 & 66 & 0.939 & 0\\
\hline
5 & 3 & 35 & 41 & 0.854 & 0\\
\hline
5 & 4 & 8 & 10 & 0.800 & 0\\
\hline
5 & 5 & 65 & 76 & 0.855 & 1\\
\hline
\end{tabular}
\end{table}

Now, just to get a look at what we are comparing when we run the
group-time DDs, let's reshape this data to wide (just to see it):

\begin{table}
\centering
\begin{tabular}[t]{r|r|r|r|r|r|r|r|r|r|r}
\hline
group & psba_t1 & psba_t2 & psba_t3 & psba_t4 & psba_t5 & tpop_t1 & tpop_t2 & tpop_t3 & tpop_t4 & tpop_t5\\
\hline
2 & 0.631 & 0.711 & 0.814 & 0.846 & 0.826 & 898 & 90 & 102 & 13 & 144\\
\hline
3 & 0.678 & 0.770 & 0.664 & 0.800 & 0.784 & 1455 & 165 & 125 & 30 & 232\\
\hline
4 & 0.778 & 0.807 & 0.673 & 0.750 & 0.868 & 1128 & 140 & 101 & 16 & 167\\
\hline
5 & 0.854 & 0.939 & 0.854 & 0.800 & 0.855 & 556 & 66 & 41 & 10 & 76\\
\hline
\end{tabular}
\end{table}

Okay, now let's estimate the impact using the CS DD method:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Use not{-}yet{-}treated as comparison group}
\NormalTok{atts\_cs }\OtherTok{\textless{}{-}}\NormalTok{ did}\SpecialCharTok{::}\FunctionTok{att\_gt}\NormalTok{(}\AttributeTok{yname =} \StringTok{"psba"}\NormalTok{, }\CommentTok{\# name of the LHS variable}
                       \AttributeTok{tname =} \StringTok{"time"}\NormalTok{, }\CommentTok{\# name of the time variable}
                       \AttributeTok{idname =} \StringTok{"dist\_id"}\NormalTok{, }\CommentTok{\# name of the id variable}
                       \AttributeTok{gname =} \StringTok{"group"}\NormalTok{, }\CommentTok{\# name of the first treatment period}
                       \AttributeTok{data =}\NormalTok{ d\_sba, }\CommentTok{\# name of the data}
                       \AttributeTok{xformla =} \ConstantTok{NULL}\NormalTok{,}
                       \AttributeTok{weightsname =} \StringTok{"tpop"}\NormalTok{,}
                       \AttributeTok{est\_method =} \StringTok{"reg"}\NormalTok{, }\CommentTok{\# estimation method.}
                       \AttributeTok{control\_group =} \StringTok{"notyettreated"}\NormalTok{, }\CommentTok{\# set the control group}
                       \AttributeTok{bstrap =} \ConstantTok{TRUE}\NormalTok{, }\CommentTok{\# if TRUE compute boostrapped SE}
                       \AttributeTok{biters =} \DecValTok{1000}\NormalTok{, }\CommentTok{\# number of boostrap interations}
                       \AttributeTok{print\_details =} \ConstantTok{FALSE}\NormalTok{, }\CommentTok{\# if TRUE, print detailed results}
                       \AttributeTok{panel =} \ConstantTok{FALSE}\NormalTok{) }\CommentTok{\# panel or repeated cross{-}sectional}
\FunctionTok{summary}\NormalTok{(atts\_cs)}
\end{Highlighting}
\end{Shaded}

A summary of the estimates, SEs, and 95\% CIs (based on 1000
bootstrapped replications) is below:

\begin{table}
\centering
\begin{tabular}[t]{l|r|r|r|r|r|r}
\hline
term & group & time & estimate & std.error & conf.low & conf.high\\
\hline
ATT(2,2) & 2 & 2 & 0.011 & 0.095 & -0.197 & 0.219\\
\hline
ATT(2,3) & 2 & 3 & 0.260 & 0.143 & -0.052 & 0.573\\
\hline
ATT(2,4) & 2 & 4 & 0.269 & 0.096 & 0.059 & 0.479\\
\hline
ATT(3,2) & 3 & 2 & 0.045 & 0.090 & -0.151 & 0.241\\
\hline
ATT(3,3) & 3 & 3 & 0.018 & 0.147 & -0.304 & 0.341\\
\hline
ATT(3,4) & 3 & 4 & 0.170 & 0.063 & 0.032 & 0.308\\
\hline
ATT(4,2) & 4 & 2 & -0.062 & 0.115 & -0.315 & 0.190\\
\hline
ATT(4,3) & 4 & 3 & -0.048 & 0.144 & -0.363 & 0.267\\
\hline
ATT(4,4) & 4 & 4 & 0.130 & 0.275 & -0.472 & 0.733\\
\hline
\end{tabular}
\end{table}

One thing that is immediately different from the TWFE method is that we
get an entire suite of ATTs for each group and time period, which allows
us to see:

\begin{itemize}
\tightlist
\item
  heterogeneity across both groups treated at different times (e.g., the
  ATT in the first year of treatment is much larger for the group first
  treated at time=2 (ATT(2,2) = 0.01) relative to the estimated effect
  in the first year of treatment for the group first treated at time 4,
  i.e., ATT(4,4) = 0.13, though both estimates are imprecise); and
\item
  as well as different times for each treatment group, e.g.., the impact
  at time 3 for the group first treated at time 2 is 0.26 relative to
  0.01 for the first year of treatment.
\end{itemize}

Let's take a quick detour to understand where these estimates are coming
from.

\hypertarget{group-time-atts}{%
\subsection{Group Time ATTs}\label{group-time-atts}}

The core of the CS estimator is the group-time ATT. They define groups
based on when they were first treated and

\hypertarget{group-2}{%
\subsubsection{Group 2}\label{group-2}}

The basic idea of the group-time ATTs is to estimate a series of ATTs
for each group \(G\) that is treated at time \(T\). So if we wanted to
estimate the ATT at time=2 for the group that is first treated at
time=2, we calculate the `long' difference, i.e., post minus pre for the
treated group (\(G=2\)) and the difference for all groups \emph{not
already treated} for the same period. Thus, the groups we are comparing
to estimate ATT(2,2) are:

\begin{table}
\centering
\begin{tabular}[t]{>{}r|>{}r|>{}r|>{}r|>{}r|>{}r}
\hline
group & time1 & time2 & time3 & time4 & time5\\
\hline
\cellcolor{white}{2} & \cellcolor{red}{\textcolor{black}{0.631}} & \cellcolor{red}{\textcolor{black}{0.711}} & \cellcolor{white}{0.814} & \cellcolor{white}{0.846} & \cellcolor{white}{0.826}\\
\hline
\cellcolor{white}{3} & \cellcolor{lightgray}{\textcolor{black}{0.678}} & \cellcolor{lightgray}{\textcolor{black}{0.770}} & \cellcolor{white}{0.664} & \cellcolor{white}{0.800} & \cellcolor{white}{0.784}\\
\hline
\cellcolor{white}{4} & \cellcolor{lightgray}{\textcolor{black}{0.778}} & \cellcolor{lightgray}{\textcolor{black}{0.807}} & \cellcolor{white}{0.673} & \cellcolor{white}{0.750} & \cellcolor{white}{0.868}\\
\hline
\cellcolor{white}{5} & \cellcolor{lightgray}{\textcolor{black}{0.854}} & \cellcolor{lightgray}{\textcolor{black}{0.939}} & \cellcolor{white}{0.854} & \cellcolor{white}{0.800} & \cellcolor{white}{0.855}\\
\hline
\multicolumn{6}{l}{\rule{0pt}{1em}\textit{Note: }}\\
\multicolumn{6}{l}{\rule{0pt}{1em}Red = treated, Gray = untreated}\\
\end{tabular}
\end{table}

If we take the population-weighted average SBA proportions for these two
groups, we get

\begin{verbatim}
## `summarise()` has grouped output by 'g22'. You can override using the `.groups` argument.
\end{verbatim}

\begin{table}
\centering
\begin{tabular}{r|r|r|r|>{}r}
\hline
g22 & time1 & time2 & Long diff & ATT\_2\_2\\
\hline
0 & 0.745 & 0.814 & 0.069 & \textbf{NA}\\
\hline
1 & 0.631 & 0.711 & 0.080 & \textbf{0.011}\\
\hline
\end{tabular}
\end{table}

Now, we can ask about how the effect in Group 2 changes with time after
the intervention. The ATT(2,3) asks about the estimated treatment effect
at time 3 (\(t=3\)) for the group that was first treated at time 2
(\(g=2\)). To get this estimate, we now create a similar 2x2 table but
are using time 3 as the `post' estimate. But note here that, since group
3 (\(G=3\)) is treated at time 3, we don't want to include it as a part
of our control group, we that means we restrict our control comparison
to only those groups that are \textbf{not} treated by time 3. So we are
comparing:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gt }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kbl}\NormalTok{(}\AttributeTok{digits=}\DecValTok{3}\NormalTok{, }\AttributeTok{escape =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_styling}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{), }\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{background =} \StringTok{"red"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{row\_spec}\NormalTok{(}\DecValTok{2}\NormalTok{, }\AttributeTok{background =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{row\_spec}\NormalTok{(}\DecValTok{3}\SpecialCharTok{:}\DecValTok{4}\NormalTok{, }\AttributeTok{background  =} \StringTok{"lightgray"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{), }\AttributeTok{background =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\DecValTok{1}\NormalTok{, }\AttributeTok{background =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_minimal}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{footnote}\NormalTok{(}\AttributeTok{general =} \StringTok{"Red = treated, Gray = untreated"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\begin{tabular}[t]{>{}r|>{}r|>{}r|>{}r|>{}r|>{}r}
\hline
group & time1 & time2 & time3 & time4 & time5\\
\hline
\cellcolor{white}{2} & \cellcolor{red}{\textcolor{black}{0.631}} & \cellcolor{white}{0.711} & \cellcolor{red}{\textcolor{black}{0.814}} & \cellcolor{white}{0.846} & \cellcolor{white}{0.826}\\
\hline
\cellcolor{white}{3} & \cellcolor{white}{\textcolor{black}{0.678}} & \cellcolor{white}{0.770} & \cellcolor{white}{\textcolor{black}{0.664}} & \cellcolor{white}{0.800} & \cellcolor{white}{0.784}\\
\hline
\cellcolor{white}{4} & \cellcolor{lightgray}{\textcolor{black}{0.778}} & \cellcolor{white}{0.807} & \cellcolor{lightgray}{\textcolor{black}{0.673}} & \cellcolor{white}{0.750} & \cellcolor{white}{0.868}\\
\hline
\cellcolor{white}{5} & \cellcolor{lightgray}{\textcolor{black}{0.854}} & \cellcolor{white}{0.939} & \cellcolor{lightgray}{\textcolor{black}{0.854}} & \cellcolor{white}{0.800} & \cellcolor{white}{0.855}\\
\hline
\multicolumn{6}{l}{\rule{0pt}{1em}\textit{Note: }}\\
\multicolumn{6}{l}{\rule{0pt}{1em}Red = treated, Gray = untreated}\\
\end{tabular}
\end{table}

And we get:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d\_agg }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{((time}\SpecialCharTok{==}\DecValTok{1} \SpecialCharTok{|}\NormalTok{ time}\SpecialCharTok{==}\DecValTok{3}\NormalTok{) }\SpecialCharTok{\&}\NormalTok{ group}\SpecialCharTok{!=}\DecValTok{3}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{g23 =} \FunctionTok{if\_else}\NormalTok{(group}\SpecialCharTok{==}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(g23, time) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{tsba =} \FunctionTok{sum}\NormalTok{(tsba),}
            \AttributeTok{tpop =} \FunctionTok{sum}\NormalTok{(tpop),}
            \AttributeTok{psba =}\NormalTok{ tsba }\SpecialCharTok{/}\NormalTok{ tpop) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(g23, time, psba) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_wider}\NormalTok{(}\AttributeTok{names\_from =}\NormalTok{ time, }\AttributeTok{values\_from =}\NormalTok{ psba,}
              \AttributeTok{names\_prefix =} \StringTok{"time"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Long diff}\StringTok{\textasciigrave{}} \OtherTok{=} \StringTok{\textasciigrave{}}\AttributeTok{time3}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{time1}\StringTok{\textasciigrave{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{ATT\_2\_3 =} \StringTok{\textasciigrave{}}\AttributeTok{Long diff}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \FunctionTok{lag}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Long diff}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{default =} \ConstantTok{NA}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable}\NormalTok{(}\AttributeTok{digits=}\DecValTok{3}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\DecValTok{5}\NormalTok{, }\AttributeTok{bold=}\ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'g23'. You can override using the `.groups` argument.
\end{verbatim}

\begin{table}
\centering
\begin{tabular}{r|r|r|r|>{}r}
\hline
g23 & time1 & time3 & Long diff & ATT\_2\_3\\
\hline
0 & 0.803 & 0.725 & -0.078 & \textbf{NA}\\
\hline
1 & 0.631 & 0.814 & 0.182 & \textbf{0.26}\\
\hline
\end{tabular}
\end{table}

We can of course extend our view of how the treatment effect evolves for
Group 2 by calculating the effect of being treated at time 4 for the
group that was first treated at time 2, i.e., ATT(2,4). This is
comparing:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gt }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kbl}\NormalTok{(}\AttributeTok{digits=}\DecValTok{3}\NormalTok{, }\AttributeTok{escape =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_styling}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{5}\NormalTok{), }\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{background =} \StringTok{"red"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{row\_spec}\NormalTok{(}\DecValTok{2}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{background =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{row\_spec}\NormalTok{(}\DecValTok{4}\NormalTok{, }\AttributeTok{background  =} \StringTok{"lightgray"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\DecValTok{6}\NormalTok{, }\AttributeTok{background =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{), }\AttributeTok{background =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_minimal}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{footnote}\NormalTok{(}\AttributeTok{general =} \StringTok{"Red = treated, Gray = untreated"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\begin{tabular}[t]{>{}r|>{}r|>{}r|>{}r|>{}r|>{}r}
\hline
group & time1 & time2 & time3 & time4 & time5\\
\hline
\cellcolor{white}{2} & \cellcolor{red}{\textcolor{black}{0.631}} & \cellcolor{white}{0.711} & \cellcolor{white}{0.814} & \cellcolor{red}{\textcolor{black}{0.846}} & \cellcolor{white}{0.826}\\
\hline
\cellcolor{white}{3} & \cellcolor{white}{\textcolor{black}{0.678}} & \cellcolor{white}{0.770} & \cellcolor{white}{0.664} & \cellcolor{white}{\textcolor{black}{0.800}} & \cellcolor{white}{0.784}\\
\hline
\cellcolor{white}{4} & \cellcolor{white}{\textcolor{black}{0.778}} & \cellcolor{white}{0.807} & \cellcolor{white}{0.673} & \cellcolor{white}{\textcolor{black}{0.750}} & \cellcolor{white}{0.868}\\
\hline
\cellcolor{white}{5} & \cellcolor{lightgray}{\textcolor{black}{0.854}} & \cellcolor{white}{0.939} & \cellcolor{white}{0.854} & \cellcolor{lightgray}{\textcolor{black}{0.800}} & \cellcolor{white}{0.855}\\
\hline
\multicolumn{6}{l}{\rule{0pt}{1em}\textit{Note: }}\\
\multicolumn{6}{l}{\rule{0pt}{1em}Red = treated, Gray = untreated}\\
\end{tabular}
\end{table}

Note that the control group here also changes, since at \(t=4\) group 4
has now been treated, so we exclude them from the control group for this
comparison. And the estimate is:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d\_agg }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{((time}\SpecialCharTok{==}\DecValTok{1} \SpecialCharTok{|}\NormalTok{ time}\SpecialCharTok{==}\DecValTok{4}\NormalTok{) }\SpecialCharTok{\&}\NormalTok{ group}\SpecialCharTok{!=}\DecValTok{3} \SpecialCharTok{\&}\NormalTok{ group}\SpecialCharTok{!=}\DecValTok{4}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{g24 =} \FunctionTok{if\_else}\NormalTok{(group}\SpecialCharTok{==}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(g24, time) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{tsba =} \FunctionTok{sum}\NormalTok{(tsba),}
            \AttributeTok{tpop =} \FunctionTok{sum}\NormalTok{(tpop),}
            \AttributeTok{psba =}\NormalTok{ tsba }\SpecialCharTok{/}\NormalTok{ tpop) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(g24, time, psba) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_wider}\NormalTok{(}\AttributeTok{names\_from =}\NormalTok{ time, }\AttributeTok{values\_from =}\NormalTok{ psba,}
              \AttributeTok{names\_prefix =} \StringTok{"time"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Long diff}\StringTok{\textasciigrave{}} \OtherTok{=} \StringTok{\textasciigrave{}}\AttributeTok{time4}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{time1}\StringTok{\textasciigrave{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{ATT\_2\_4 =} \StringTok{\textasciigrave{}}\AttributeTok{Long diff}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \FunctionTok{lag}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Long diff}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{default =} \ConstantTok{NA}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable}\NormalTok{(}\AttributeTok{digits=}\DecValTok{3}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\DecValTok{5}\NormalTok{, }\AttributeTok{bold=}\ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'g24'. You can override using the `.groups` argument.
\end{verbatim}

\begin{table}
\centering
\begin{tabular}{r|r|r|r|>{}r}
\hline
g24 & time1 & time4 & Long diff & ATT\_2\_4\\
\hline
0 & 0.854 & 0.800 & -0.054 & \textbf{NA}\\
\hline
1 & 0.631 & 0.846 & 0.215 & \textbf{0.269}\\
\hline
\end{tabular}
\end{table}

\hypertarget{group-3}{%
\subsubsection{Group 3}\label{group-3}}

Now, what about the groups that are first treated at time 3, i.e.,
(\(t=3\))? Since we actually have more than one pre-period for this
group, we can also see whether there is some evidence of non-parallel
trends by looking at, for example, the ATT(3,2), which is the effect of
being treated at \textbf{time=2} for the group that is first treated at
time 3. In essence, we are comparing the pre-intervention `long
difference' between \(t=1\) and \(t=2\) for the group eventually treated
at time 3 with the same long difference among the controls:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gt }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kbl}\NormalTok{(}\AttributeTok{digits=}\DecValTok{3}\NormalTok{, }\AttributeTok{escape =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_styling}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\DecValTok{2}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{background =} \StringTok{"red"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{row\_spec}\NormalTok{(}\DecValTok{3}\SpecialCharTok{:}\DecValTok{4}\NormalTok{, }\AttributeTok{background  =} \StringTok{"lightgray"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{row\_spec}\NormalTok{(}\DecValTok{1}\NormalTok{, }\AttributeTok{background =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\DecValTok{4}\SpecialCharTok{:}\DecValTok{6}\NormalTok{, }\AttributeTok{background =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\DecValTok{1}\NormalTok{, }\AttributeTok{background =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_minimal}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{footnote}\NormalTok{(}\AttributeTok{general =} \StringTok{"Red = treated, Gray = untreated"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\begin{tabular}[t]{>{}r|>{}r|>{}r|>{}r|>{}r|>{}r}
\hline
group & time1 & time2 & time3 & time4 & time5\\
\hline
\cellcolor{white}{2} & \cellcolor{white}{\textcolor{black}{0.631}} & \cellcolor{white}{\textcolor{black}{0.711}} & \cellcolor{white}{0.814} & \cellcolor{white}{0.846} & \cellcolor{white}{0.826}\\
\hline
\cellcolor{white}{3} & \cellcolor{red}{\textcolor{black}{0.678}} & \cellcolor{red}{\textcolor{black}{0.770}} & \cellcolor{white}{0.664} & \cellcolor{white}{0.800} & \cellcolor{white}{0.784}\\
\hline
\cellcolor{white}{4} & \cellcolor{lightgray}{\textcolor{black}{0.778}} & \cellcolor{lightgray}{\textcolor{black}{0.807}} & \cellcolor{white}{0.673} & \cellcolor{white}{0.750} & \cellcolor{white}{0.868}\\
\hline
\cellcolor{white}{5} & \cellcolor{lightgray}{\textcolor{black}{0.854}} & \cellcolor{lightgray}{\textcolor{black}{0.939}} & \cellcolor{white}{0.854} & \cellcolor{white}{0.800} & \cellcolor{white}{0.855}\\
\hline
\multicolumn{6}{l}{\rule{0pt}{1em}\textit{Note: }}\\
\multicolumn{6}{l}{\rule{0pt}{1em}Red = treated, Gray = untreated}\\
\end{tabular}
\end{table}

The estimate of the ATT(3,2) is:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d\_agg }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(time }\SpecialCharTok{\textless{}} \DecValTok{3} \SpecialCharTok{\&}\NormalTok{ group }\SpecialCharTok{!=} \DecValTok{2}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{g32 =} \FunctionTok{if\_else}\NormalTok{(group}\SpecialCharTok{==}\DecValTok{3}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(g32, time) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{tsba =} \FunctionTok{sum}\NormalTok{(tsba),}
            \AttributeTok{tpop =} \FunctionTok{sum}\NormalTok{(tpop),}
            \AttributeTok{psba =}\NormalTok{ tsba }\SpecialCharTok{/}\NormalTok{ tpop) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(g32, time, psba) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_wider}\NormalTok{(}\AttributeTok{names\_from =}\NormalTok{ time, }\AttributeTok{values\_from =}\NormalTok{ psba,}
              \AttributeTok{names\_prefix =} \StringTok{"time"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Long diff}\StringTok{\textasciigrave{}} \OtherTok{=} \StringTok{\textasciigrave{}}\AttributeTok{time2}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{time1}\StringTok{\textasciigrave{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{ATT\_3\_2 =} \StringTok{\textasciigrave{}}\AttributeTok{Long diff}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \FunctionTok{lag}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Long diff}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{default =} \ConstantTok{NA}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable}\NormalTok{(}\AttributeTok{digits=}\DecValTok{3}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\DecValTok{5}\NormalTok{, }\AttributeTok{bold=}\ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'g32'. You can override using the `.groups` argument.
\end{verbatim}

\begin{table}
\centering
\begin{tabular}{r|r|r|r|>{}r}
\hline
g32 & time1 & time2 & Long diff & ATT\_3\_2\\
\hline
0 & 0.803 & 0.85 & 0.046 & \textbf{NA}\\
\hline
1 & 0.678 & 0.77 & 0.091 & \textbf{0.045}\\
\hline
\end{tabular}
\end{table}

Now for the treatment effect at time 3 for the groups first treated at
time 3 we are comparing:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gt }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kbl}\NormalTok{(}\AttributeTok{digits=}\DecValTok{3}\NormalTok{, }\AttributeTok{escape =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_styling}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\DecValTok{3}\SpecialCharTok{:}\DecValTok{4}\NormalTok{, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{background =} \StringTok{"red"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{row\_spec}\NormalTok{(}\DecValTok{3}\SpecialCharTok{:}\DecValTok{4}\NormalTok{, }\AttributeTok{background  =} \StringTok{"lightgray"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{row\_spec}\NormalTok{(}\DecValTok{1}\NormalTok{, }\AttributeTok{background =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{), }\AttributeTok{background =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\DecValTok{1}\NormalTok{, }\AttributeTok{background =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_minimal}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{footnote}\NormalTok{(}\AttributeTok{general =} \StringTok{"Red = treated, Gray = untreated"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\begin{tabular}[t]{>{}r|>{}r|>{}r|>{}r|>{}r|>{}r}
\hline
group & time1 & time2 & time3 & time4 & time5\\
\hline
\cellcolor{white}{2} & \cellcolor{white}{0.631} & \cellcolor{white}{\textcolor{black}{0.711}} & \cellcolor{white}{\textcolor{black}{0.814}} & \cellcolor{white}{0.846} & \cellcolor{white}{0.826}\\
\hline
\cellcolor{white}{3} & \cellcolor{white}{0.678} & \cellcolor{red}{\textcolor{black}{0.770}} & \cellcolor{red}{\textcolor{black}{0.664}} & \cellcolor{white}{0.800} & \cellcolor{white}{0.784}\\
\hline
\cellcolor{white}{4} & \cellcolor{white}{0.778} & \cellcolor{lightgray}{\textcolor{black}{0.807}} & \cellcolor{lightgray}{\textcolor{black}{0.673}} & \cellcolor{white}{0.750} & \cellcolor{white}{0.868}\\
\hline
\cellcolor{white}{5} & \cellcolor{white}{0.854} & \cellcolor{lightgray}{\textcolor{black}{0.939}} & \cellcolor{lightgray}{\textcolor{black}{0.854}} & \cellcolor{white}{0.800} & \cellcolor{white}{0.855}\\
\hline
\multicolumn{6}{l}{\rule{0pt}{1em}\textit{Note: }}\\
\multicolumn{6}{l}{\rule{0pt}{1em}Red = treated, Gray = untreated}\\
\end{tabular}
\end{table}

The estimate of the ATT(3,3) is:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d\_agg }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(time }\SpecialCharTok{\textgreater{}}\DecValTok{1} \SpecialCharTok{\&}\NormalTok{ time }\SpecialCharTok{\textless{}} \DecValTok{4} \SpecialCharTok{\&}\NormalTok{ group }\SpecialCharTok{!=} \DecValTok{2}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{g33 =} \FunctionTok{if\_else}\NormalTok{(group}\SpecialCharTok{==}\DecValTok{3}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(g33, time) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{tsba =} \FunctionTok{sum}\NormalTok{(tsba),}
            \AttributeTok{tpop =} \FunctionTok{sum}\NormalTok{(tpop),}
            \AttributeTok{psba =}\NormalTok{ tsba }\SpecialCharTok{/}\NormalTok{ tpop) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(g33, time, psba) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_wider}\NormalTok{(}\AttributeTok{names\_from =}\NormalTok{ time, }\AttributeTok{values\_from =}\NormalTok{ psba,}
              \AttributeTok{names\_prefix =} \StringTok{"time"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Long diff}\StringTok{\textasciigrave{}} \OtherTok{=} \StringTok{\textasciigrave{}}\AttributeTok{time3}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{time2}\StringTok{\textasciigrave{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{ATT\_3\_3 =} \StringTok{\textasciigrave{}}\AttributeTok{Long diff}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \FunctionTok{lag}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Long diff}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{default =} \ConstantTok{NA}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable}\NormalTok{(}\AttributeTok{digits=}\DecValTok{3}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\DecValTok{5}\NormalTok{, }\AttributeTok{bold=}\ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'g33'. You can override using the `.groups` argument.
\end{verbatim}

\begin{table}
\centering
\begin{tabular}{r|r|r|r|>{}r}
\hline
g33 & time2 & time3 & Long diff & ATT\_3\_3\\
\hline
0 & 0.85 & 0.725 & -0.124 & \textbf{NA}\\
\hline
1 & 0.77 & 0.664 & -0.106 & \textbf{0.018}\\
\hline
\end{tabular}
\end{table}

The groups for comparison for the estimated treatment effect at time 4
for the groups first treated at time 3 now also need to exclude group 4,
since it has received the treatment at time 4, but note also that the
`pre-intervention' period is still (\(t=2\)) since group 3 was actually
treated at time 3. So, we care comparing:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gt }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kbl}\NormalTok{(}\AttributeTok{digits=}\DecValTok{3}\NormalTok{, }\AttributeTok{escape =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_styling}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{5}\NormalTok{), }\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{background =} \StringTok{"red"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{row\_spec}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{), }\AttributeTok{background =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{row\_spec}\NormalTok{(}\DecValTok{4}\NormalTok{, }\AttributeTok{background  =} \StringTok{"lightgray"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{6}\NormalTok{), }\AttributeTok{background =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_minimal}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{footnote}\NormalTok{(}\AttributeTok{general =} \StringTok{"Red = treated, Gray = untreated"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\begin{tabular}[t]{>{}r|>{}r|>{}r|>{}r|>{}r|>{}r}
\hline
group & time1 & time2 & time3 & time4 & time5\\
\hline
\cellcolor{white}{2} & \cellcolor{white}{0.631} & \cellcolor{white}{\textcolor{black}{0.711}} & \cellcolor{white}{0.814} & \cellcolor{white}{\textcolor{black}{0.846}} & \cellcolor{white}{0.826}\\
\hline
\cellcolor{white}{3} & \cellcolor{white}{0.678} & \cellcolor{red}{\textcolor{black}{0.770}} & \cellcolor{white}{0.664} & \cellcolor{red}{\textcolor{black}{0.800}} & \cellcolor{white}{0.784}\\
\hline
\cellcolor{white}{4} & \cellcolor{white}{0.778} & \cellcolor{white}{\textcolor{black}{0.807}} & \cellcolor{white}{0.673} & \cellcolor{white}{\textcolor{black}{0.750}} & \cellcolor{white}{0.868}\\
\hline
\cellcolor{white}{5} & \cellcolor{white}{0.854} & \cellcolor{lightgray}{\textcolor{black}{0.939}} & \cellcolor{white}{0.854} & \cellcolor{lightgray}{\textcolor{black}{0.800}} & \cellcolor{white}{0.855}\\
\hline
\multicolumn{6}{l}{\rule{0pt}{1em}\textit{Note: }}\\
\multicolumn{6}{l}{\rule{0pt}{1em}Red = treated, Gray = untreated}\\
\end{tabular}
\end{table}

The estimate of the ATT(3,4) is:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d\_agg }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{((time }\SpecialCharTok{==} \DecValTok{2} \SpecialCharTok{|}\NormalTok{ time }\SpecialCharTok{==} \DecValTok{4}\NormalTok{) }\SpecialCharTok{\&}\NormalTok{ (group }\SpecialCharTok{==} \DecValTok{3} \SpecialCharTok{|}\NormalTok{ group }\SpecialCharTok{==} \DecValTok{5}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{g34 =} \FunctionTok{if\_else}\NormalTok{(group}\SpecialCharTok{==}\DecValTok{3}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(g34, time) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{tsba =} \FunctionTok{sum}\NormalTok{(tsba),}
            \AttributeTok{tpop =} \FunctionTok{sum}\NormalTok{(tpop),}
            \AttributeTok{psba =}\NormalTok{ tsba }\SpecialCharTok{/}\NormalTok{ tpop) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(g34, time, psba) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_wider}\NormalTok{(}\AttributeTok{names\_from =}\NormalTok{ time, }\AttributeTok{values\_from =}\NormalTok{ psba,}
              \AttributeTok{names\_prefix =} \StringTok{"time"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Long diff}\StringTok{\textasciigrave{}} \OtherTok{=} \StringTok{\textasciigrave{}}\AttributeTok{time4}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{time2}\StringTok{\textasciigrave{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{ATT\_3\_4 =} \StringTok{\textasciigrave{}}\AttributeTok{Long diff}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \FunctionTok{lag}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Long diff}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{default =} \ConstantTok{NA}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable}\NormalTok{(}\AttributeTok{digits=}\DecValTok{3}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\DecValTok{5}\NormalTok{, }\AttributeTok{bold=}\ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\begin{tabular}{r|r|r|r|>{}r}
\hline
g34 & time2 & time4 & Long diff & ATT\_3\_4\\
\hline
0 & 0.939 & 0.8 & -0.139 & \textbf{NA}\\
\hline
1 & 0.770 & 0.8 & 0.030 & \textbf{0.17}\\
\hline
\end{tabular}
\end{table}

\hypertarget{group-4}{%
\subsubsection{Group 4}\label{group-4}}

Since we have untreated groups remaining at time 5, the last group we
can estimate a `clean' ATT for is Group 4. In this case, we also now
have 2 pre-intervention periods we can use to assess the parallel trends
assumption. For the time 2 periods before treatment starts for Group 4,
we can compare the change in SBA between time 1 and time 2 for our
treated group, i.e., the group first treated at time 4, and a control
group. In this case the control group will only include Group 3 and
Group 5, since Group 2 is treated at (\(t=2\)) and we have to exclude
it. So our comparison groups are:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gt }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kbl}\NormalTok{(}\AttributeTok{digits=}\DecValTok{3}\NormalTok{, }\AttributeTok{escape =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_styling}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{), }\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{background =} \StringTok{"red"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{row\_spec}\NormalTok{(}\DecValTok{1}\NormalTok{, }\AttributeTok{background =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{row\_spec}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{), }\AttributeTok{background =} \StringTok{"lightgray"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{), }\AttributeTok{background =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_minimal}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{footnote}\NormalTok{(}\AttributeTok{general =} \StringTok{"Red = treated, Gray = untreated"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\begin{tabular}[t]{>{}r|>{}r|>{}r|>{}r|>{}r|>{}r}
\hline
group & time1 & time2 & time3 & time4 & time5\\
\hline
\cellcolor{white}{2} & \cellcolor{white}{\textcolor{black}{0.631}} & \cellcolor{white}{\textcolor{black}{0.711}} & \cellcolor{white}{0.814} & \cellcolor{white}{0.846} & \cellcolor{white}{0.826}\\
\hline
\cellcolor{white}{3} & \cellcolor{lightgray}{\textcolor{black}{0.678}} & \cellcolor{lightgray}{\textcolor{black}{0.770}} & \cellcolor{white}{0.664} & \cellcolor{white}{0.800} & \cellcolor{white}{0.784}\\
\hline
\cellcolor{white}{4} & \cellcolor{red}{\textcolor{black}{0.778}} & \cellcolor{red}{\textcolor{black}{0.807}} & \cellcolor{white}{0.673} & \cellcolor{white}{0.750} & \cellcolor{white}{0.868}\\
\hline
\cellcolor{white}{5} & \cellcolor{lightgray}{\textcolor{black}{0.854}} & \cellcolor{lightgray}{\textcolor{black}{0.939}} & \cellcolor{white}{0.854} & \cellcolor{white}{0.800} & \cellcolor{white}{0.855}\\
\hline
\multicolumn{6}{l}{\rule{0pt}{1em}\textit{Note: }}\\
\multicolumn{6}{l}{\rule{0pt}{1em}Red = treated, Gray = untreated}\\
\end{tabular}
\end{table}

Again, taking the population-weighted estimate for the control group and
the estimates for Group 4, we can calculate the ATT at time 2 for the
group first treated at time 4, i.e., ATT(4,2):

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d\_agg }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(time }\SpecialCharTok{\textless{}} \DecValTok{3} \SpecialCharTok{\&}\NormalTok{ group }\SpecialCharTok{\textgreater{}=} \DecValTok{3}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{g42 =} \FunctionTok{if\_else}\NormalTok{(group}\SpecialCharTok{==}\DecValTok{4}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(g42, time) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{tsba =} \FunctionTok{sum}\NormalTok{(tsba),}
            \AttributeTok{tpop =} \FunctionTok{sum}\NormalTok{(tpop),}
            \AttributeTok{psba =}\NormalTok{ tsba }\SpecialCharTok{/}\NormalTok{ tpop) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(g42, time, psba) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_wider}\NormalTok{(}\AttributeTok{names\_from =}\NormalTok{ time, }\AttributeTok{values\_from =}\NormalTok{ psba,}
              \AttributeTok{names\_prefix =} \StringTok{"time"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Long diff}\StringTok{\textasciigrave{}} \OtherTok{=} \StringTok{\textasciigrave{}}\AttributeTok{time2}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{time1}\StringTok{\textasciigrave{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{ATT\_4\_2 =} \StringTok{\textasciigrave{}}\AttributeTok{Long diff}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \FunctionTok{lag}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Long diff}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{default =} \ConstantTok{NA}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable}\NormalTok{(}\AttributeTok{digits=}\DecValTok{3}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\DecValTok{5}\NormalTok{, }\AttributeTok{bold=}\ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\begin{tabular}{r|r|r|r|>{}r}
\hline
g42 & time1 & time2 & Long diff & ATT\_4\_2\\
\hline
0 & 0.727 & 0.818 & 0.091 & \textbf{NA}\\
\hline
1 & 0.778 & 0.807 & 0.029 & \textbf{-0.062}\\
\hline
\end{tabular}
\end{table}

As you might expect, we now make the same progression for the addition
ATTs for the the group first treated at time 4. First, for the next ATT
for the pre-intervention period we want the treatment effect at time 3
for the group that is first treated at time 4. That means comparing only
Groups 4 and 5 (since group 3 is treated at time 3, it has to be
excluded from the control population):

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gt }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kbl}\NormalTok{(}\AttributeTok{digits=}\DecValTok{3}\NormalTok{, }\AttributeTok{escape =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_styling}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{), }\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{background =} \StringTok{"red"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{row\_spec}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }\AttributeTok{background =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{row\_spec}\NormalTok{(}\DecValTok{4}\NormalTok{, }\AttributeTok{background =} \StringTok{"lightgray"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{), }\AttributeTok{background =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_minimal}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{footnote}\NormalTok{(}\AttributeTok{general =} \StringTok{"Red = treated, Gray = untreated"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\begin{tabular}[t]{>{}r|>{}r|>{}r|>{}r|>{}r|>{}r}
\hline
group & time1 & time2 & time3 & time4 & time5\\
\hline
\cellcolor{white}{2} & \cellcolor{white}{0.631} & \cellcolor{white}{\textcolor{black}{0.711}} & \cellcolor{white}{\textcolor{black}{0.814}} & \cellcolor{white}{0.846} & \cellcolor{white}{0.826}\\
\hline
\cellcolor{white}{3} & \cellcolor{white}{0.678} & \cellcolor{white}{\textcolor{black}{0.770}} & \cellcolor{white}{\textcolor{black}{0.664}} & \cellcolor{white}{0.800} & \cellcolor{white}{0.784}\\
\hline
\cellcolor{white}{4} & \cellcolor{white}{0.778} & \cellcolor{red}{\textcolor{black}{0.807}} & \cellcolor{red}{\textcolor{black}{0.673}} & \cellcolor{white}{0.750} & \cellcolor{white}{0.868}\\
\hline
\cellcolor{white}{5} & \cellcolor{white}{0.854} & \cellcolor{lightgray}{\textcolor{black}{0.939}} & \cellcolor{lightgray}{\textcolor{black}{0.854}} & \cellcolor{white}{0.800} & \cellcolor{white}{0.855}\\
\hline
\multicolumn{6}{l}{\rule{0pt}{1em}\textit{Note: }}\\
\multicolumn{6}{l}{\rule{0pt}{1em}Red = treated, Gray = untreated}\\
\end{tabular}
\end{table}

And the resulting ATT(4,3) is:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d\_agg }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{((time }\SpecialCharTok{==}\DecValTok{2} \SpecialCharTok{|}\NormalTok{ time }\SpecialCharTok{==} \DecValTok{3}\NormalTok{) }\SpecialCharTok{\&}\NormalTok{ group }\SpecialCharTok{\textgreater{}=} \DecValTok{4}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{g43 =} \FunctionTok{if\_else}\NormalTok{(group}\SpecialCharTok{==}\DecValTok{4}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(g43, time) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{tsba =} \FunctionTok{sum}\NormalTok{(tsba),}
            \AttributeTok{tpop =} \FunctionTok{sum}\NormalTok{(tpop),}
            \AttributeTok{psba =}\NormalTok{ tsba }\SpecialCharTok{/}\NormalTok{ tpop) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(g43, time, psba) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_wider}\NormalTok{(}\AttributeTok{names\_from =}\NormalTok{ time, }\AttributeTok{values\_from =}\NormalTok{ psba,}
              \AttributeTok{names\_prefix =} \StringTok{"time"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Long diff}\StringTok{\textasciigrave{}} \OtherTok{=} \StringTok{\textasciigrave{}}\AttributeTok{time3}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{time2}\StringTok{\textasciigrave{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{ATT\_4\_3 =} \StringTok{\textasciigrave{}}\AttributeTok{Long diff}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \FunctionTok{lag}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Long diff}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{default =} \ConstantTok{NA}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable}\NormalTok{(}\AttributeTok{digits=}\DecValTok{3}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\DecValTok{5}\NormalTok{, }\AttributeTok{bold=}\ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\begin{tabular}{r|r|r|r|>{}r}
\hline
g43 & time2 & time3 & Long diff & ATT\_4\_3\\
\hline
0 & 0.939 & 0.854 & -0.086 & \textbf{NA}\\
\hline
1 & 0.807 & 0.673 & -0.134 & \textbf{-0.048}\\
\hline
\end{tabular}
\end{table}

Finally, the last ATT we can estimate is the effect of being treated at
time 4 for the group that is first treated at time 4. Again, we can only
compare groups 4 and 5 here, since every other group has already been
treated. So we are comparing:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gt }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kbl}\NormalTok{(}\AttributeTok{digits=}\DecValTok{3}\NormalTok{, }\AttributeTok{escape =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_styling}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{), }\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{background =} \StringTok{"red"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{row\_spec}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }\AttributeTok{background =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{row\_spec}\NormalTok{(}\DecValTok{4}\NormalTok{, }\AttributeTok{background =} \StringTok{"lightgray"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{6}\NormalTok{), }\AttributeTok{background =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_minimal}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{footnote}\NormalTok{(}\AttributeTok{general =} \StringTok{"Red = treated, Gray = untreated"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\begin{tabular}[t]{>{}r|>{}r|>{}r|>{}r|>{}r|>{}r}
\hline
group & time1 & time2 & time3 & time4 & time5\\
\hline
\cellcolor{white}{2} & \cellcolor{white}{0.631} & \cellcolor{white}{0.711} & \cellcolor{white}{\textcolor{black}{0.814}} & \cellcolor{white}{\textcolor{black}{0.846}} & \cellcolor{white}{0.826}\\
\hline
\cellcolor{white}{3} & \cellcolor{white}{0.678} & \cellcolor{white}{0.770} & \cellcolor{white}{\textcolor{black}{0.664}} & \cellcolor{white}{\textcolor{black}{0.800}} & \cellcolor{white}{0.784}\\
\hline
\cellcolor{white}{4} & \cellcolor{white}{0.778} & \cellcolor{white}{0.807} & \cellcolor{red}{\textcolor{black}{0.673}} & \cellcolor{red}{\textcolor{black}{0.750}} & \cellcolor{white}{0.868}\\
\hline
\cellcolor{white}{5} & \cellcolor{white}{0.854} & \cellcolor{white}{0.939} & \cellcolor{lightgray}{\textcolor{black}{0.854}} & \cellcolor{lightgray}{\textcolor{black}{0.800}} & \cellcolor{white}{0.855}\\
\hline
\multicolumn{6}{l}{\rule{0pt}{1em}\textit{Note: }}\\
\multicolumn{6}{l}{\rule{0pt}{1em}Red = treated, Gray = untreated}\\
\end{tabular}
\end{table}

And the resulting ATT(4,3) is:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d\_agg }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{((time }\SpecialCharTok{==}\DecValTok{3} \SpecialCharTok{|}\NormalTok{ time }\SpecialCharTok{==} \DecValTok{4}\NormalTok{) }\SpecialCharTok{\&}\NormalTok{ group }\SpecialCharTok{\textgreater{}=} \DecValTok{4}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{g44 =} \FunctionTok{if\_else}\NormalTok{(group}\SpecialCharTok{==}\DecValTok{4}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(g44, time) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{tsba =} \FunctionTok{sum}\NormalTok{(tsba),}
            \AttributeTok{tpop =} \FunctionTok{sum}\NormalTok{(tpop),}
            \AttributeTok{psba =}\NormalTok{ tsba }\SpecialCharTok{/}\NormalTok{ tpop) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(g44, time, psba) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_wider}\NormalTok{(}\AttributeTok{names\_from =}\NormalTok{ time, }\AttributeTok{values\_from =}\NormalTok{ psba,}
              \AttributeTok{names\_prefix =} \StringTok{"time"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Long diff}\StringTok{\textasciigrave{}} \OtherTok{=} \StringTok{\textasciigrave{}}\AttributeTok{time4}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{time3}\StringTok{\textasciigrave{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{ATT\_4\_4 =} \StringTok{\textasciigrave{}}\AttributeTok{Long diff}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \FunctionTok{lag}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Long diff}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{default =} \ConstantTok{NA}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable}\NormalTok{(}\AttributeTok{digits=}\DecValTok{3}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\DecValTok{5}\NormalTok{, }\AttributeTok{bold=}\ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\begin{tabular}{r|r|r|r|>{}r}
\hline
g44 & time3 & time4 & Long diff & ATT\_4\_4\\
\hline
0 & 0.854 & 0.80 & -0.054 & \textbf{NA}\\
\hline
1 & 0.673 & 0.75 & 0.077 & \textbf{0.13}\\
\hline
\end{tabular}
\end{table}

\hypertarget{weighted-atts}{%
\section{Weighted ATTs}\label{weighted-atts}}

\end{document}
